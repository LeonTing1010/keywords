# NeedMiner 系统架构

NeedMiner 是一个未满足需求挖掘与价值验证系统，通过融合搜索引擎数据挖掘与大语言模型的认知分析能力，专注于发现互联网上尚未被满足的高价值用户需求。

## 整体架构

系统采用模块化设计，各组件通过清晰的接口交互，架构如下：

```
┌───────────────────────────────────────────────────────┐
│                 WorkflowController                    │
│  协调流程，专注于挖掘和验证未满足高价值需求              │
└────────┬────────────────┬───────────────┬─────────────┘
         │                │               │        
         ▼                ▼               ▼        
┌────────────────┐ ┌────────────────┐ ┌────────────────┐
│  KeywordMiner  │ │ UserJourneySim │ │ContentAnalyzer │
│ 关键词挖掘+筛选 │ │需求缺口路径检测│ │ 高价值需求识别 │
└────────┬───────┘ └───────┬────────┘ └────────┬───────┘
         │                 │                    │
         └────────────────┐▼────────────────────┘
                          │        
                          ▼                 
             ┌─────────────────────────────┐
             │        LLMServiceHub        │
             │     优化需求价值分析能力    │
             └──────────────┬──────────────┘
                            │
                            ▼
                  ┌───────────────────┐
                  │  MarkdownReporter │
                  │ 聚焦需求价值展示  │
                  └───────────────────┘
```

## 详细架构实现

NeedMiner 的架构由以下主要组件组成，每个组件都围绕"未满足高价值需求挖掘"这一核心价值设计：

### 1. 工作流控制器 (WorkflowController)

**路径**: `src/core/WorkflowController.ts`

**职责**: 
- 协调各模块执行顺序和数据流转
- 管理分析过程的状态和结果整合
- 实现"价值筛选器"，尽早丢弃低价值需求
- 优先分配资源给高潜力需求分析

**核心方法**:
- `executeWorkflow(keyword: string)`: 执行完整分析流程，返回综合结果
- `analyzeUnmetNeeds(keywords)`: 分析未满足的需求
- `evaluateNeedValue(unmetNeeds)`: 评估未满足需求的价值

**优化方向**:
- 根据关键词"需求性"预判断，分配不同分析资源
- 优化分析顺序，让高潜力需求获得更多分析深度
- 减少非核心分析流程的资源消耗

### 2. 关键词挖掘器 (SimpleKeywordDiscovery)

**路径**: `src/discovery/SimpleKeywordDiscovery.ts`

**职责**: 
- 通过搜索引擎自动补全发现潜在需求关键词
- 筛选掉非潜在需求的关键词
- 优先挖掘带问题词的关键词组合

**核心方法**:
- `discover(keyword)`: 开始关键词发现流程
- `getSuggestions(keyword)`: 获取搜索引擎补全建议
- `filterNeedKeywords(keywords)`: 筛选潜在需求关键词

**优化方向**:
- 添加"需求关键词模式识别"，筛选出更可能代表未满足需求的关键词
- 实现基于语义的关键词聚类，减少分析重复内容
- 优先挖掘带问题词("怎么"、"如何"、"有没有")的关键词组合

### 3. 用户旅程模拟器 (UserJourneySim)

**路径**: `src/journey/UserJourneySim.ts`

**职责**: 
- 模拟用户搜索路径，识别"无满意结果"的路径
- 分析查询修改模式，找出无法满足需求的证据
- 识别决策点和搜索意图变化

**核心方法**:
- `simulateJourney(initialQuery)`: 模拟完整搜索旅程
- `identifyDecisionPoints(steps)`: 识别决策转换点
- `detectSearchFailures(steps)`: 检测搜索失败路径

**优化方向**:
- 关注"搜索失败路径"，识别用户持续修改查询但无满意结果的模式
- 分析用户查询改写模式，找出查询精确化但结果质量下降的情况
- 减少通用搜索分析，专注未找到答案的路径追踪

### 4. 内容分析器 (ContentAnalyzer)

**路径**: `src/core/ContentAnalyzer.ts`

**职责**: 
- 分析搜索结果内容质量，识别未满足的高价值需求
- 评估需求的真实性、市场价值和实现难度
- 提供未满足需求的详细原因分析

**核心方法**:
- `analyzeKeyword(keyword)`: 分析单个关键词是否是未满足需求
- `batchAnalyzeUnmetNeeds(keywords)`: 批量分析未满足需求
- `evaluateContentQuality(results)`: 评估内容质量和缺口

**优化方向**:
- 实现"需求价值评分算法"，基于市场潜力、实现难度、竞争程度评分
- 增强真实搜索结果抓取功能，不仅分析标题摘要，还抓取页面内容
- 引入竞争分析维度，评估已有解决方案的完整度与差距

### 5. LLM服务中心 (LLMServiceHub)

**路径**: `src/llm/LLMServiceHub.ts`

**职责**: 
- 统一管理AI模型交互，提供分析能力
- 为各模块提供专业化分析接口
- 优化提示词，围绕"高价值未满足需求识别"这一目标

**核心方法**:
- `analyze(analysisType, data, options)`: 执行特定类型的分析任务
- `verifyUnmetNeeds(data)`: 验证未满足需求的真实性
- `evaluateNeedValue(data)`: 评估需求价值

**优化方向**:
- 实现分级分析模式，先快速筛选，再深入分析有潜力的需求
- 减少旅程和内容分析的token消耗，提高分析效率
- 针对需求价值判断持续优化提示词

### 6. Markdown报告生成器 (MarkdownReporter)

**路径**: `src/tools/markdownReporter.ts`

**职责**: 
- 生成聚焦于未满足需求的分析报告
- 突出展示高价值需求和验证方案
- 为每个需求提供简化解决方案和冷启动MVP方案

**核心方法**:
- `generateReport(result, outputPath)`: 生成报告并输出
- `createBasicMarkdown(result)`: 创建基础Markdown内容
- `generateUnmetNeedsSection(result)`: 生成未满足需求部分内容

**优化方向**:
- 设计更直观的未满足需求价值展示方式，加入商业价值预估
- 进一步精简非核心内容，报告主体聚焦未满足需求及验证方案
- 添加可视化部分，展示需求价值与难度的矩阵图

## 数据流

NeedMiner的数据流向如下：

1. **输入阶段**：用户提供初始关键词和分析选项
2. **关键词挖掘**：SimpleKeywordDiscovery从搜索引擎获取潜在需求关键词
3. **旅程模拟**：UserJourneySim模拟用户搜索路径，识别未找到满意答案的路径
4. **内容分析**：ContentAnalyzer评估搜索结果质量，识别未满足需求
5. **需求验证**：通过LLM验证需求的真实性和价值
6. **价值评估**：对未满足需求进行价值评分和排序
7. **输出阶段**：生成聚焦于高价值未满足需求和验证方案的报告

## 核心优化方向

为更聚焦于"挖掘未满足高价值需求"这一核心价值，NeedMiner将在以下方向持续优化：

### 1. 内容分析器强化
- 开发需求价值评分算法，量化市场潜力
- 增强对抓取内容的深度分析能力
- 引入竞争分析维度，评估现有解决方案差距

### 2. 工作流重构
- 实现更高效的价值筛选流程
- 针对高潜力需求分配更多分析资源
- 减少非核心流程的计算开销

### 3. LLM提示词优化
- 持续改进所有提示词，专注于高价值需求识别
- 实现分级分析模式，节约token消耗
- 强化对需求价值判断的准确性

### 4. 报告精简
- 突出核心价值，将未满足需求部分置于最前
- 减少非核心内容篇幅
- 增强需求价值和验证方案的可视化展示

## 技术实现

NeedMiner 采用TypeScript实现，主要技术特点包括：

- **强类型系统**：利用TypeScript的类型系统确保代码健壮性
- **模块化设计**：清晰的模块边界和责任划分
- **异步处理**：使用Promise和async/await处理网络请求
- **LLM集成**：深度集成大语言模型分析能力
- **可扩展接口**：支持扩展不同搜索引擎和分析模型

## 部署架构

NeedMiner 支持多种部署模式：

- **本地命令行工具**：作为开发者工具在本地运行
- **API服务**：提供RESTful API供第三方系统集成
- **网页应用**：可部署为网页界面，供非技术用户使用 