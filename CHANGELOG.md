# 变更日志

项目的所有显著变更都将记录在此文件中。

格式基于[Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循[语义化版本](https://semver.org/lang/zh-CN/)。

## [Unreleased]

## [2.5.0] - 2025-05-04

### 新增
- 创建了新的`promptLibrary.ts`模块，集中管理提示词
- 为不同LLM交互任务实现了模块化系统角色和任务指令
- 添加了`getSystemPrompt()`工具函数，用于动态组合提示词

### 变更
- 精简核心价值描述约50%，同时保留关键信息
- 优化JSON响应处理，使用OpenAI原生响应格式
- 在规划和报告工作流中将多次API调用合并为单次调用
- 统一了代码库中的领域命名约定
- 增强会话上下文管理，避免冗余信息

### 移除
- 清除`IntentAnalyzer.ts`中的重复系统指令
- 移除用户提示中的冗余JSON格式指令

### 技术改进
- 每次API调用的token使用量预计减少30-40%
- 在`planNextIteration`和`generateFinalReport`方法中减少50%的API调用次数
- 通过集中式提示词管理提高代码可维护性
- 通过标准化提示模式增强系统一致性

## [2.4.0] - 2023-12-XX

### 新增
- 增强了LLM服务的会话管理，添加元数据跟踪和语言控制
- 添加了会话导出/导入功能，便于调试
- 为不同类型的查询添加温度控制参数
- 创建了更好的会话上下文管理，包含全面的历史摘要
- 添加了调试信息和自动会话清理功能
- 实现了标准化的会话ID生成器，确保全局唯一性和一致性
- 添加了会话ID解析工具，便于调试和日志分析

### 变更
- 将中文提示模板翻译为英文，放在新文件`src/config/configSettings.ts`中
- 将索引文件重命名为更有意义的名称：
  - 创建了`src/types/keywordTypes.ts`，包含英文类型定义
  - 更新了原始索引文件，重新导出新文件中的所有内容
- 改进了IntentAnalyzer，为每次迭代使用唯一的会话ID
- 增强了JSON响应解析，改进字段名称标准化
- 更新了LLM交互以保持语言一致性
- 将会话ID生成逻辑标准化，采用统一格式：`kn_[类型]_[版本]_[关键词哈希]_[时间戳]_[随机码]_[后缀]`

### 优化
- 优化了关键词样本选择逻辑，确保代表性更全面
- 提高了长尾关键词和多领域发现的效率
- 减少了会话上下文长度，防止超出大模型上下文窗口限制
- 系统日志信息优化，增加更多有意义的调试信息
- 对短期会话实现自动清理，减少内存占用

### 架构
- 实现了更清晰的代码组织结构，通过重命名和文件分离
- 保持了向后兼容性，确保原有功能不受影响
- 将系统配置和类型定义分离，减少耦合
- 增强了系统多语言支持，为未来国际化铺平道路
- 创建了专用模块管理会话ID生成，增强可维护性

### 修复
- 修复了recommendedQueries在缺失或包含对象时的处理问题
- 改进了LLM响应中JSON解析的错误处理
- 为缺失的评估维度添加了默认值检查
- 解决了不同分析阶段会话ID格式不一致的问题

## [2.3.0] - 2023-11-05

### 新增
- 实现动态满意度阈值机制，随迭代次数自动调整阈值
- 添加最小强制迭代次数设置，确保足够的领域广度探索
- 增加领域覆盖度检测，防止关键词过度集中在单一领域
- 新增领域分布分析，为最终报告提供跨行业覆盖度分析

### 增强
- 全面优化评分系统，增加两个关键维度：
  - 领域覆盖度(domainCoverage)：评估关键词跨行业/主题领域的广度
  - 重复度惩罚(repetitionPenalty)：降低重复性关键词的价值，促进多样性
- 调整评分权重，提高多样性(20%)和商业价值(18%)权重
- 降低相关性(15%)和搜索量(5%)权重，更关注长尾价值
- 优化查询选择算法，基于迭代阶段实现不同策略：
  - 早期迭代：轮换查询，优先广度探索
  - 中期迭代：选择与前几轮领域差异最大的查询
  - 后期迭代：聚焦高潜力领域深入挖掘

### 改进
- 改进样本选择算法，确保更好的多样性代表性：
  - 25%长尾词(最长关键词)
  - 25%商业词(含商业指示词的关键词)
  - 15%基础词(无修饰的核心词)
  - 35%随机词(确保覆盖面)
- 增强意图分析提示词模板，注重领域多样性引导
- 优化迭代评估提示词，引导大模型关注领域覆盖和避免重复
- 改进迭代规划策略，增加领域差异考量和早期广度/后期深度平衡指导

### 修复
- 解决单一领域过度集中问题，通过新的领域识别和自动调整机制防止关键词同质化
- 修复迭代规划中未考虑领域多样性导致的主题窄化问题

## [2.2.0] - 2023-10-20

### 增强
- 全面增强大语言模型交互能力，提高关键词分析质量
- 将系统核心价值和功能描述集成到LLM提示中，使模型更好理解项目目标
- 增强文本提示模板，使其更符合英语表达习惯
- 改进各分析阶段的系统提示，提供更详细的分析指导

### 改进
- 改进LLMService结构，增加coreValueDescription属性存储系统核心价值描述
- 增强IntentAnalyzer中的categorizeKeywords方法，提供详细的意图分类指导
- 增强generateQueries方法，加入多种查询生成策略指导
- 改进evaluateIteration方法，明确多维度评估标准
- 优化planNextIteration方法，提供更全面的迭代规划策略
- 增强generateFinalReport方法，明确商业价值和内容机会分析重点

### 更改
- 将所有向LLM提交的提示文本改为英文，以提高模型理解和处理效率
- 保留代码注释和文档为中文，维持项目的本地化特性

## [2.1.1] - 2023-10-15

### 清理
- 删除历史遗留代码，移除旧的 src/engines 目录
- 删除旧的 src/utils 目录，相关功能已迁移至专用模块
- 所有文件引用统一使用新的 src/providers 目录结构
- 确保项目结构清晰，消除冗余代码


### 重构
- 项目目录结构重组，采用功能模块化设计
- 主入口文件从`keywordsTool.ts`更名为`keywordNova.ts`
- 重构CLI处理，将`keywordsCli.ts`替换为`keywordNovaCli.ts`
- 更新VS Code调试配置，适配新的项目结构
- 清理历史遗留代码，移除冗余文件
- 优化命令行参数处理，保持向后兼容

### 改进
- 改进错误处理机制
- 添加针对关键词挖掘的专用调试工具
- 增强配置管理，集中化配置项
- 更新文档，反映新的项目架构

## [2.0.0] - 2023-09-15

### 新增
- 重构为支持多搜索引擎的架构
- 添加抽象的`SearchEngine`基类
- 添加`SearchEngineFactory`工厂类，实现灵活创建搜索引擎实例
- 添加`BaiduSearchEngine`实现，支持中文搜索习惯
- 新增`keywordsTool.ts`作为统一入口，支持多引擎选择
- 改进的命令行参数解析，支持引擎选择
- 针对不同搜索引擎的查询策略定制
- 更新README.md文档，添加多引擎架构说明和使用方法

### 更改
- 将Google相关功能重构为`GoogleSearchEngine`类
- `googleKeywords.ts`保留作为向后兼容
- 统一文件命名方式，包含引擎名称前缀

### 修复
- 修复二次查询断点续传问题
- 改进验证码检测逻辑

## [1.2.0] - 2023-07-15

### 增强
- 改进迭代查询引擎，添加迭代历史记录功能
- 修改LLM分析流程，将历史迭代数据传递给模型，实现更智能的查询优化
- 增强最终报告生成，包含迭代历史分析和模式识别
- 添加新的提示模板，专门针对历史感知分析

### 改进
- 优化LLM提示结构，更好地利用迭代过程中产生的信息
- 改进日志记录，提供更详细的迭代进程信息
- 增强查询策略生成，避免重复之前效果不佳的查询模式
- 完善类型定义，增加对迭代历史的结构化支持

## [1.1.0] - 2023-07-10

### 重构
- 简化代码结构，使迭代查询引擎成为默认搜索方法
- 移除多余查询模式，保留简单模式以向后兼容
- 更新命令行参数，简化用户交互体验
- 更新文档，反映新的简化工作流

### 改进
- 优化迭代查询引擎配置选项
- 改进LLM分析结果的呈现方式

## [1.0.0] - 2023-07-01

### 新增
- 引入LLM集成，实现关键词价值和意图分析
- 创建迭代查询引擎，持续优化搜索找到更好的长尾关键词
- 实现关键词分析器，为不同意图的关键词分类
- 开发评分系统，从多个维度评估关键词价值
- 项目正式更名为"KeywordNova"，定位为"意图挖掘与长尾关键词爆破系统"

### 改进
- 优化浏览器处理逻辑，提高稳定性
- 改进错误处理和日志记录
- 提高代码复用性和可维护性

## [0.2.0] - 2023-06-15

### 新增
- 支持代理配置
- 添加命令行参数控制批处理大小和延迟
- 实现失败后重试机制
- 添加多种输出格式：JSON、CSV和Markdown

### 改进
- 提高搜索引擎查询稳定性
- 改进关键词提取算法
- 优化二次查询逻辑

## [0.1.0] - 2023-06-01

### 初始版本
- 实现基本的Google自动补全查询功能
- 支持按字母组合进行全面查询
- 添加二次查询支持，基于初始关键词进行扩展
- 基本命令行界面
- JSON格式输出结果 
